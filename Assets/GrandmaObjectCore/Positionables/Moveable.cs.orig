using System.Collections.Generic;
using UnityEngine;

<<<<<<< HEAD
namespace Grandma
{ 
=======
namespace Grandma.Core
{
   
>>>>>>> 2954370c0558e354a591bc737709ae01e38d781a
    public class Moveable : Positionable
    {
        //MoveControllers can be set via inspector. Do not initialise a new list here
        //or the inspector fields will be wiped!
        [SerializeField]
        private List<MoveController> allModes;
        private MoveController active;

        public List<MoveController> AllModes
        {
            get
            {
                if(allModes == null)
                {
                    allModes = new List<MoveController>();
                }

                return allModes;
            }
        }

<<<<<<< HEAD
        //Calls SwitchMode for this controller on Start
        public MoveController StartingController;

        public MoveController Active { get; private set; }

        protected override void Awake()
        {
            base.Awake();
            
            SwitchMode(StartingController);
        }

=======
>>>>>>> 2954370c0558e354a591bc737709ae01e38d781a
        //Can be null - no movement system will be active
        public void SwitchMode(MoveController switchTo)
        { 
            if (Active != null)
            {
                Active.Deactivate();
            }

            //Lazy add
            if (AllModes.Contains(switchTo) == false)
            {
                AllModes.Add(switchTo);
            }

            Active = switchTo;

            if (Active != null)
            {
                Active.Activate();
            }
        }

        /// <summary>
        /// For debugging
        /// </summary>
        public void NextMode()
        {
            if(AllModes.Count <= 0)
            {
                return;
            }

            int currIndex = allModes.FindIndex(x => x == Active);
            SwitchMode(AllModes[(currIndex + 1) % AllModes.Count]);
        }
    }

<<<<<<< HEAD
=======
    [RequireComponent(typeof(Rigidbody))]
    public abstract class RBMove : MoveController
    {
        protected Rigidbody rb;
        protected override void Awake()
        {
            base.Awake();
            rb = GetComponent<Rigidbody>();
        }
    }

    [RequireComponent(typeof(Rigidbody2D))]
    public abstract class RBMove2D : MoveController
    {
        protected Rigidbody2D rb;
        protected override void Awake()
        {
            base.Awake();
            rb = GetComponent<Rigidbody2D>();
        }
    }

>>>>>>> 2954370c0558e354a591bc737709ae01e38d781a
}